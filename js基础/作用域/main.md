# 作用域

作用域就是一个独立的地盘，让变量不会外泄、暴露出去。也就是说作用域最大的用处就是隔离变量，不同作用域下同名变量不会有冲突

## 全局作用域和函数作用域

### var

1. 在函数体中用var声明的为局部对象而不使用var声明的为全局对象。
2. 在函数外不论用不用var都是全局对象。
3. 全局对象是window对象的属性。
4. 用var是声明全局变量而不用则是给全局对象新增一个属性。区别在于用var不能用delete删除，而不用var可以删除。

```
var a = 1;
b = 2
function func() {
    var c = 3;
    d = 4;
}
func();
console.log(window.a, window.b, window.c, window.d);
console.log(delete a);
console.log(delete b);
```
返回
```
1,2,undefined,4
false
true
```

## 块级作用域

块级作用域可以由let和const声明，在以下两个作用域内构成块级作用域。块级作用域内无法被外部访问

- 在一个函数内部
- 在一个代码块内部（花括号）

let和const和class声明的有如下性质

- 同一作用域内无法重复声明，否则报错。
- 变量提升带来的临时性死区。

## 作用域链

指当前作用域下找不的变量会逐层往（创建他的父级作用域内）寻找变量。
而不是父级作用域寻找。两个例子

- 闭包
- 立即执行函数

```
var IFFE = 10;

function a() {
    console.log(IFFE)
}
function fun() {
    var IFFE = 5;
    (function() {
        a()
    })();
}
fun() //输出10
```
这里的IFFE不是往闭包里寻找，而是在a函数创建的位置中往父级寻找，即全局。

## 作用域与执行上下文

JavaScript的执行分为：解释和执行两个阶段

解释阶段

- 词法分析
- 语法分析
- 作用域规则确定

执行阶段：

- 创建执行上下文
- 执行函数代码
- 垃圾回收

执行上下文在运行时确定，随时可能改变；作用域在定义时就确定，并且不会改变。
最显著的是this在执行上下文时才确定。所以会改变
