# 前端网络安全

## csrf 跨站请求伪造 cross-site request forgery

csrf主要原理是当用户成功登录某个网站并将登录凭证放在cookie中。当用户访问黑客网站，网站中会（通过图片或表单）自动向目标网站发送恶意请求，该请求会自动携带用户的cookie。  
目标网站服务器无法判断该用户是否为用户想要情况，仅通过cookie判断身份。从而用户受害。

![image](./csrf.png)

### 防御措施

- 验证码：在用户做出操作前做验证码验证能有效的避免用户被操纵发送请求，但是用户体验很差。 
- token包含几个部分
  - 随机数
  - 用户信息
  - 服务端签名生成的散列值
- 上述token的构造确保了token无法被伪造。当用户第一次登陆时返回一个token并存储在localstorage中，确保不会被cookie携带。当每次提交请求的时候手动将token添加在请求头或者内容中。避免csrf的攻击
- token可以存储在cookie中，但只是找个位置存，真正发表单请求的时候还是要单独发token。不只验证cookie中的token

## xss 跨站脚本攻击 cross-site scripting

跨站脚本攻击指攻击者通过某种方式将恶意脚本加载到页面中执行，脚本将用户的个人信息发送给黑客。黑客再实行攻击。  
xss分为两种

- 反射攻击：黑客构造一个xss漏洞页面等待用户点击，用户点击后访问服务器，服务器将含有xss代码的页面返回，代码执行并窃取用户信息。反射性攻击不会对后台数据造成影响，仅限于攻击用户一次。比如说搜索页面的url中携带了搜索内容，如果搜索内容被替换为xss代码则点击会触发xss攻击。
- 存储攻击：黑客在输入框等输入xss代码，服务器不加审核的将内容添加到数据库中。再返回显示，所有浏览该网页的用户都会被攻击。该攻击的区别是该攻击代码会持久存储。

### 防御方法

- 后台对前端输入的所有信息都必须进行校验
- 前端对用户提交的信息做```html encode```即把html实体字符解析成纯文本
- 对```script,iframe,onclick```等进行过滤。